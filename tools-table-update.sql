-- Add content column to existing tools table
ALTER TABLE tools ADD COLUMN IF NOT EXISTS content TEXT;

-- Update the comment for the content column
COMMENT ON COLUMN tools.content IS 'Detailed tool documentation with markdown formatting';

-- Optional: Update existing sample data to include content
-- This will only work if you have existing rows
UPDATE tools 
SET content = 'Tool documentation coming soon...' 
WHERE content IS NULL;

-- If you want to insert sample data with content (run this after adding the column)
INSERT INTO tools (title, description, content, image_url, category, link, created_at) VALUES
(
    'Network Scanner',
    'Advanced network reconnaissance and vulnerability scanning tool for discovering hosts and services.',
    '# Network Scanner\n\n## Overview\nNetwork Scanner is a comprehensive tool designed for network reconnaissance and vulnerability assessment. It combines multiple scanning techniques to provide detailed information about network infrastructure.\n\n## Features\n\n### Core Capabilities\n\n- **Host Discovery**: Identify active hosts on the network\n- **Port Scanning**: Comprehensive port scanning with multiple techniques\n- **Service Detection**: Identify running services and versions\n- **OS Detection**: Determine operating system of target hosts\n- **Vulnerability Scanning**: Check for known vulnerabilities\n- **Network Mapping**: Visual representation of network topology\n\n### Scanning Techniques\n\n#### Host Discovery Methods\n\n```bash\n# ARP scan (local network)\narp-scan -l\n\n# ICMP echo request\nping -c 4 192.168.1.1\n\n# TCP SYN ping\nnmap -sn 192.168.1.0/24\n\n# UDP ping\nnmap -sU -sn 192.168.1.0/24\n```\n\n#### Port Scanning Methods\n\n| Technique | Description | Use Case |\n|-----------|-------------|----------|\n| TCP Connect | Full three-way handshake | Reliable scanning |\n| TCP SYN | Half-open scan | Stealthy scanning |\n| UDP Scan | UDP port detection | Service discovery |\n| FIN Scan | Stealth technique | Firewall evasion |\n| Xmas Scan | Christmas tree scan | Advanced evasion |\n\n## Installation\n\n### Prerequisites\n\n- Python 3.7+\n- Scapy library\n- Nmap (optional, for enhanced features)\n\n### Setup Instructions\n\n```bash\n# Clone the repository\ngit clone https://github.com/g1ass/network-scanner\ncd network-scanner\n\n# Install dependencies\npip install -r requirements.txt\n\n# Install scapy (if not in requirements)\npip install scapy\n\n# Run the tool\npython main.py --help\n```\n\n### Requirements File\n\n```txt\nscapy==2.4.5\npython-nmap==0.7.1\ncolorama==0.4.4\ntabulate==0.9.0\nrequests==2.28.1\n```\n\n## Usage Examples\n\n### Basic Network Scan\n\n```bash\n# Scan entire network\npython main.py --target 192.168.1.0/24\n\n# Scan specific host\npython main.py --target 192.168.1.100\n\n# Scan specific ports\npython main.py --target 192.168.1.100 --ports 22,80,443\n\n# Custom port range\npython main.py --target 192.168.1.100 --ports 1-1000\n```\n\n### Advanced Scanning\n\n```bash\n# Comprehensive scan with service detection\npython main.py --target 192.168.1.0/24 --service-detection\n\n# OS detection\npython main.py --target 192.168.1.100 --os-detection\n\n# Aggressive scan with timing\npython main.py --target 192.168.1.100 --aggressive --timing 4\n\n# Export results to file\npython main.py --target 192.168.1.0/24 --output results.json\n```\n\n## Configuration\n\n### Configuration File (config.ini)\n\n```ini\n[scanner]\ndefault_timeout = 1.0\nmax_threads = 100\nretry_attempts = 3\n\n[output]\ndefault_format = table\ninclude_timestamps = true\n\n[advanced]\nenable_service_detection = true\nenable_os_detection = false\nvuln_database = /path/to/vuln.db\n```\n\n### Command Line Options\n\n```\nNetwork Scanner v1.0\n\nUsage: python main.py [OPTIONS]\n\nOptions:\n  --target TEXT          Target IP or range (required)\n  --ports TEXT           Specific ports or range (default: 1-1000)\n  --timeout FLOAT        Timeout in seconds (default: 1.0)\n  --threads INTEGER      Number of threads (default: 50)\n  --service-detection    Enable service detection\n  --os-detection         Enable OS detection\n  --aggressive           Enable aggressive scanning\n  --timing INTEGER       Timing template (1-5)\n  --output TEXT          Output file path\n  --format TEXT          Output format (table|json|xml|csv)\n  --help                 Show this message and exit\n```\n\n## Output Formats\n\n### Table Format\n\n```\n+----------------+-------+--------+------------------------+\n| IP Address     | Port  | State  | Service                |\n+----------------+-------+--------+------------------------+\n| 192.168.1.1    | 22    | open   | OpenSSH 7.4           |\n| 192.168.1.1    | 80    | open   | Apache httpd 2.4.29   |\n| 192.168.1.100  | 443   | open   | nginx 1.18.0          |\n+----------------+-------+--------+------------------------+\n```\n\n### JSON Format\n\n```json\n{\n  "scan_info": {\n    "target": "192.168.1.0/24",\n    "timestamp": "2023-12-07T10:30:00Z",\n    "scan_duration": 45.2\n  },\n  "hosts": [\n    {\n      "ip": "192.168.1.1",\n      "hostname": "router.local",\n      "os": "Linux 4.15",\n      "ports": [\n        {\n          "port": 22,\n          "protocol": "tcp",\n          "state": "open",\n          "service": "OpenSSH 7.4",\n          "version": "7.4"\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Advanced Features\n\n### Vulnerability Scanning\n\n```python\n# Example vulnerability check\ndef check_vulnerabilities(host, port, service):\n    vulnerabilities = []\n    \n    # Check for outdated SSH version\n    if service == "OpenSSH" and version < "7.6":\n        vulnerabilities.append({\n            "severity": "Medium",\n            "cve": "CVE-2018-15473",\n            "description": "User enumeration vulnerability"\n        })\n    \n    return vulnerabilities\n```\n\n### Network Mapping\n\n```python\n# Generate network topology\ndef generate_network_map(scan_results):\n    graph = nx.Graph()\n    \n    for host in scan_results:\n        graph.add_node(host[\'ip\'], \n                      hostname=host.get(\'hostname\'),\n                      os=host.get(\'os\'))\n        \n        for port in host[\'ports\']:\n            if port[\'state\'] == \'open\':\n                graph.add_edge(host[\'ip\'], f"{host[\'ip\']}:{port[\'port\']}",\n                              service=port[\'service\'])\n    \n    return graph\n```\n\n## Performance Optimization\n\n### Parallel Processing\n\n```python\nimport concurrent.futures\nfrom threading import Lock\n\ndef parallel_scan(targets, ports, max_workers=100):\n    results = []\n    lock = Lock()\n    \n    def scan_host_port(host, port):\n        result = scan_port(host, port)\n        with lock:\n            results.append(result)\n    \n    with concurrent.futures.ThreadPoolExecutor(max_workers=max_workers) as executor:\n        futures = []\n        for host in targets:\n            for port in ports:\n                futures.append(executor.submit(scan_host_port, host, port))\n        \n        concurrent.futures.wait(futures)\n    \n    return results\n```\n\n### Rate Limiting\n\n```python\nimport time\nfrom collections import deque\n\nclass RateLimiter:\n    def __init__(self, max_requests_per_second):\n        self.max_requests = max_requests_per_second\n        self.requests = deque()\n    \n    def wait_if_needed(self):\n        now = time.time()\n        \n        # Remove old requests\n        while self.requests and self.requests[0] <= now - 1:\n            self.requests.popleft()\n        \n        # Wait if we have too many requests\n        if len(self.requests) >= self.max_requests:\n            time.sleep(1 - (now - self.requests[0]))\n        \n        self.requests.append(now)\n```\n\n## Security Considerations\n\n### Legal Usage\n\n- **Authorization**: Always have written permission\n- **Scope**: Stay within authorized boundaries\n- **Impact**: Avoid disrupting network services\n- **Documentation**: Keep detailed logs\n\n### Stealth Techniques\n\n```python\n# Randomize timing between scans\nimport random\n\ndef stealth_scan(target, ports):\n    results = []\n    for port in ports:\n        result = scan_port(target, port)\n        results.append(result)\n        \n        # Random delay between scans\n        time.sleep(random.uniform(0.1, 0.5))\n    \n    return results\n\n# Use decoy IPs\ndef decoy_scan(target, port, decoys):\n    # Send decoy packets before actual scan\n    for decoy in decoys:\n        send_syn_packet(decoy, target, port)\n    \n    # Actual scan\n    return scan_port(target, port)\n```\n\n## Troubleshooting\n\n### Common Issues\n\n#### Permission Denied\n```bash\n# Run with sudo for raw socket access\nsudo python main.py --target 192.168.1.0/24\n```\n\n#### Network Unreachable\n```bash\n# Check network connectivity\nping -c 4 192.168.1.1\n\n# Check routing table\nip route show\n```\n\n#### Slow Performance\n```bash\n# Reduce thread count\npython main.py --target 192.168.1.0/24 --threads 10\n\n# Increase timeout\npython main.py --target 192.168.1.0/24 --timeout 2.0\n```\n\n## Contributing\n\n### Development Setup\n\n```bash\n# Clone repository\ngit clone https://github.com/g1ass/network-scanner\ncd network-scanner\n\n# Create virtual environment\npython -m venv venv\nsource venv/bin/activate  # Linux/Mac\n# or\nvenv\\Scripts\\activate     # Windows\n\n# Install development dependencies\npip install -r requirements-dev.txt\n\n# Run tests\npython -m pytest tests/\n\n# Run linting\nflake8 src/\nblack src/\n```\n\n### Adding New Features\n\n1. **Fork the repository**\n2. **Create feature branch**: `git checkout -b feature/new-feature`\n3. **Make changes** and add tests\n4. **Run tests**: `python -m pytest`\n5. **Submit pull request**\n\n## License\n\nThis project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.\n\n## Disclaimer\n\nThis tool is for educational and authorized security testing purposes only. Users are responsible for ensuring they have proper authorization before scanning any networks. The authors are not responsible for any misuse of this software.\n\n> "With great power comes great responsibility." - Use responsibly and ethically.',
    'https://images.unsplash.com/photo-1550745165-9bc0b252726a?w=400&h=200&fit=crop&crop=center',
    'Reconnaissance',
    'https://github.com/g1ass/network-scanner',
    NOW()
),
(
    'Password Cracker',
    'Multi-threaded password recovery and cracking utility with support for various hash algorithms.',
    '# Password Cracker\n\n## Overview\nPassword Cracker is a powerful, multi-threaded utility designed for password recovery and security testing. It supports multiple hash algorithms and cracking techniques.\n\n## Features\n\n### Supported Hash Types\n\n- **MD5**: Message Digest 5\n- **SHA1**: Secure Hash Algorithm 1\n- **SHA256**: Secure Hash Algorithm 256-bit\n- **SHA512**: Secure Hash Algorithm 512-bit\n- **NTLM**: NT LAN Manager\n- **bcrypt**: Blowfish-based hashing\n- **MySQL**: MySQL password hashes\n- **WordPress**: WordPress password hashes\n\n### Cracking Techniques\n\n| Technique | Description | Speed | Success Rate |\n|-----------|-------------|-------|--------------|\n| Dictionary | Wordlist-based | Fast | Medium |\n| Brute Force | Character combinations | Slow | High |\n| Mask Attack | Pattern-based | Medium | High |\n| Rainbow Table | Precomputed hashes | Very Fast | High |\n| Hybrid | Combined methods | Variable | Very High |\n\n## Installation\n\n### System Requirements\n\n- Python 3.8+\n- 4GB+ RAM recommended\n- Multi-core CPU for best performance\n\n### Setup\n\n```bash\n# Clone repository\ngit clone https://github.com/g1ass/password-cracker\ncd password-cracker\n\n# Install dependencies\npip install -r requirements.txt\n\n# Download wordlists (optional)\npython download_wordlists.py\n\n# Run the tool\npython main.py --help\n```\n\n### Dependencies\n\n```txt\nhashlib==0.1.0\nmultiprocessing==0.70.12\nclick==8.1.0\ncolorama==0.4.4\ntqdm==4.64.0\npycryptodome==3.15.0\n```\n\n## Usage Examples\n\n### Basic Dictionary Attack\n\n```bash\n# Dictionary attack with default wordlist\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5\n\n# Custom wordlist\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --wordlist custom.txt\n\n# Multiple hashes\npython main.py --hashes hashes.txt --type md5 --wordlist rockyou.txt\n```\n\n### Brute Force Attack\n\n```bash\n# Brute force with character set\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --brute-force --charset "abcdefghijklmnopqrstuvwxyz0123456789" --min-length 1 --max-length 8\n\n# Numeric brute force\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --brute-force --charset "0123456789" --min-length 4 --max-length 6\n\n# Alphanumeric with symbols\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --brute-force --charset "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*" --min-length 1 --max-length 10\n```\n\n### Mask Attack\n\n```bash\n# Known pattern attack\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --mask "?u?l?l?l?d?d?d?d"\n\n# Custom mask patterns\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --mask "password?d" --min-length 8 --max-length 12\n\n# Multiple masks\npython main.py --hash "5f4dcc3b5aa765d61d8327deb882cf99" --type md5 --masks masks.txt\n```\n\n## Configuration\n\n### Mask Patterns\n\n```python\n# Common mask patterns\nMASK_PATTERNS = {\n    "lowercase": "?l",\n    "uppercase": "?u", \n    "digits": "?d",\n    "symbols": "?s",\n    "alphanumeric": "?u?l?d",\n    "all": "?u?l?d?s"\n}\n\n# Example masks\nexample_masks = [\n    "?u?l?l?l?d?d?d?d",     # Password1234\n    "?l?l?l?l?l?d?d",       # abcdef12\n    "?u?l?l?l?l?l?l?d",     # Password1\n    "?d?d?d?d?d?d",         # 123456\n    "?l?l?l?l?l?l?l?l"      # password\n]\n```\n\n### Performance Tuning\n\n```python\n# Configuration options\nconfig = {\n    "max_threads": multiprocessing.cpu_count(),\n    "chunk_size": 1000,\n    "progress_interval": 100,\n    "output_format": "table",\n    "save_session": True,\n    "resume_session": True\n}\n```\n\n## Advanced Features\n\n### Session Management\n\n```python\n# Save cracking session\ndef save_session(session_data, filename):\n    with open(filename, \'wb\') as f:\n        pickle.dump(session_data, f)\n\n# Resume session\ndef load_session(filename):\n    with open(filename, \'rb\') as f:\n        return pickle.load(f)\n```\n\n### Distributed Cracking\n\n```python\n# Master node\ndef master_distributed_crack(hash_target, hash_type, wordlist_chunks, workers):\n    results = {}\n    \n    for i, chunk in enumerate(wordlist_chunks):\n        worker = workers[i]\n        result = worker.crack_chunk(hash_target, hash_type, chunk)\n        results.update(result)\n    \n    return results\n\n# Worker node\ndef worker_crack_chunk(hash_target, hash_type, wordlist_chunk):\n    results = {}\n    \n    for word in wordlist_chunk:\n        if verify_hash(hash_target, hash_type, word):\n            results[hash_target] = word\n            break\n    \n    return results\n```\n\n### GPU Acceleration\n\n```python\n# PyOpenCL GPU acceleration\nimport pyopencl as cl\nimport numpy as np\n\ndef gpu_hash_crack(hash_target, hash_type, wordlist):\n    # Setup OpenCL context\n    ctx = cl.create_some_context()\n    queue = cl.CommandQueue(ctx)\n    \n    # Load OpenCL kernel\n    with open(\'hash_kernel.cl\', \'r\') as f:\n        kernel_code = f.read()\n    \n    program = cl.Program(ctx, kernel_code).build()\n    \n    # Transfer data to GPU\n    wordlist_buffer = cl.Buffer(ctx, cl.mem_flags.READ_ONLY | cl.mem_flags.COPY_HOST_PTR, hostbuf=wordlist.encode())\n    hash_buffer = cl.Buffer(ctx, cl.mem_flags.READ_ONLY | cl.mem_flags.COPY_HOST_PTR, hostbuf=hash_target.encode())\n    result_buffer = cl.Buffer(ctx, cl.mem_flags.WRITE_ONLY, wordlist.size)\n    \n    # Execute kernel\n    program.hash_crack(queue, (len(wordlist),), None, wordlist_buffer, hash_buffer, result_buffer)\n    \n    # Read results\n    result = np.empty_like(wordlist)\n    cl.enqueue_copy(queue, result, result_buffer)\n    \n    return result\n```\n\n## Wordlists\n\n### Included Wordlists\n\n- **rockyou.txt**: 14 million common passwords\n- **common-passwords.txt**: 10,000 most common passwords\n- **dictionary.txt**: English dictionary words\n- **names.txt**: Common names and surnames\n- **dates.txt**: Common date patterns\n\n### Custom Wordlists\n\n```python\n# Generate custom wordlist\ndef generate_wordlist(base_words, numbers, symbols):\n    wordlist = set()\n    \n    for word in base_words:\n        wordlist.add(word)\n        \n        # Add numbers\n        for num in numbers:\n            wordlist.add(f"{word}{num}")\n            wordlist.add(f"{num}{word}")\n        \n        # Add symbols\n        for sym in symbols:\n            wordlist.add(f"{word}{sym}")\n            wordlist.add(f"{sym}{word}")\n    \n    return list(wordlist)\n\n# Example usage\nbase_words = ["password", "admin", "user", "login"]\nnumbers = ["123", "2023", "2024"]\nsymbols = ["!", "@", "#", "$"]\n\ncustom_wordlist = generate_wordlist(base_words, numbers, symbols)\n```\n\n## Performance Benchmarks\n\n### Hardware Performance\n\n| CPU | Cores | Hashes/sec (MD5) | Hashes/sec (SHA256) |\n|-----|-------|------------------|---------------------|\n| Intel i7-9700K | 8 | 2.5B | 1.8B |\n| AMD Ryzen 9 5900X | 12 | 3.2B | 2.4B |\n| Intel i9-12900K | 16 | 4.1B | 3.1B |\n| AMD Threadripper 3970X | 32 | 7.8B | 5.9B |\n\n### GPU Performance\n\n| GPU | Cores | Hashes/sec (MD5) | Hashes/sec (SHA256) |\n|-----|-------|------------------|---------------------|\n| NVIDIA RTX 3080 | 8704 | 45B | 28B |\n| NVIDIA RTX 3090 | 10496 | 52B | 32B |\n| AMD RX 6800 XT | 4608 | 38B | 24B |\n| NVIDIA A100 | 6912 | 68B | 42B |\n\n## Security Considerations\n\n### Ethical Usage\n\n- **Authorization**: Only crack hashes you own or have permission to test\n- **Legal Compliance**: Follow local laws and regulations\n- **Data Protection**: Securely store and handle sensitive data\n- **Responsible Disclosure**: Report vulnerabilities responsibly\n\n### Best Practices\n\n```python\n# Secure hash verification\ndef secure_hash_verify(hash_target, candidate):\n    # Constant-time comparison to prevent timing attacks\n    return hmac.compare_digest(hash_target, candidate)\n\n# Rate limiting\ndef rate_limit_crack(attempts_per_minute):\n    last_attempt = 0\n    \n    def decorator(func):\n        def wrapper(*args, **kwargs):\n            nonlocal last_attempt\n            \n            current_time = time.time()\n            if current_time - last_attempt < 60 / attempts_per_minute:\n                time.sleep(1)\n            \n            last_attempt = time.time()\n            return func(*args, **kwargs)\n        \n        return wrapper\n    return decorator\n```\n\n## Troubleshooting\n\n### Common Issues\n\n#### Memory Issues\n```bash\n# Reduce chunk size\npython main.py --chunk-size 100\n\n# Limit threads\npython main.py --threads 4\n\n# Use streaming mode\npython main.py --stream-mode\n```\n\n#### Slow Performance\n```bash\n# Use GPU acceleration\npython main.py --gpu\n\n# Optimize wordlist\npython main.py --optimize-wordlist\n\n# Use mask attack\npython main.py --mask "?u?l?l?l?d?d?d?d"\n```\n\n## Contributing\n\n### Development Guidelines\n\n1. **Code style**: Follow PEP 8\n2. **Testing**: Include unit tests\n3. **Documentation**: Update README and inline docs\n4. **Performance**: Benchmark new features\n\n### Submitting Changes\n\n```bash\n# Fork and clone\ngit clone https://github.com/yourusername/password-cracker\ncd password-cracker\n\n# Create feature branch\ngit checkout -b feature/new-feature\n\n# Make changes and test\npython -m pytest tests/\n\n# Submit pull request\ngit push origin feature/new-feature\n```\n\n## License\n\nMIT License - see [LICENSE](LICENSE) for details.\n\n## Disclaimer\n\nThis tool is for educational and authorized security testing purposes only. Users are responsible for ensuring they have proper authorization before attempting to crack any passwords. The authors are not responsible for any misuse of this software.\n\n> "Great power comes with great responsibility." - Use ethically and legally.',
    'https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=400&h=200&fit=crop&crop=center',
    'Authentication',
    'https://github.com/g1ass/password-cracker',
    NOW()
)
ON CONFLICT DO NOTHING;
